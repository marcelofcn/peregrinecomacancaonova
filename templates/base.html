<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Peregrine com a Can√ß√£o Nova{% endblock %}</title>

  <!-- Tipografia institucional (Lato) -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet">

  <!-- CSS principal -->
  <link rel="stylesheet" href="{{ BASE_PATH }}/static/css/site.css">
</head>
<body>
  <header class="site-header">
    <a class="site-brand" href="{{ BASE_PATH }}/">
      <img src="{{ BASE_PATH }}/static/img/marca_cancao_nova_png_v140517.png" alt="Can√ß√£o Nova" />
      <div class="brand-title">Peregrine com a Can√ß√£o Nova</div>
    </a>

    <!-- Menu Desktop -->
    <nav class="site-nav" role="navigation" aria-label="Menu principal">
      <a href="{{ BASE_PATH }}/">In√≠cio</a>

      <div class="dropdown" id="menuRoteiros">
        <button class="dropbtn" onclick="toggleDropdown(event)">Roteiros ‚ñæ</button>
        <div class="dropdown-content" id="dropdownContent" aria-hidden="true">
          <a href="{{ BASE_PATH }}/roteiros/" style="font-weight:700;">üìã Todos os Roteiros</a>

          {% if meses_menu %}
            <hr style="margin:8px 0; border:none; border-top:1px solid rgba(0,0,0,0.04);">
            <div style="padding:8px 12px; font-size:0.72rem; color:var(--cn-muted); font-weight:700; text-transform:uppercase; letter-spacing:1px;">Por m√™s</div>
            {% for mes in meses_menu %}
              <a href="{{ mes.url }}">üìÖ {{ mes.nome }}</a>
            {% endfor %}
          {% endif %}
        </div>
      </div>

      <a href="#contato">Contato</a>
    </nav>

    <!-- Bot√£o Hamburger Mobile -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Abrir menu" aria-expanded="false">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
  </header>

  <!-- Menu Mobile Overlay -->
  <div class="mobile-menu-overlay" id="mobileMenuOverlay">
    <nav class="mobile-menu" role="navigation">
      <a href="{{ BASE_PATH }}/" class="mobile-menu-link">
        <span class="menu-icon">üè†</span>
        <span>In√≠cio</span>
      </a>

      <div class="mobile-menu-section">
        <div class="mobile-menu-title">Roteiros</div>
        <a href="{{ BASE_PATH }}/roteiros/" class="mobile-menu-link indent">
          <span class="menu-icon">üìã</span>
          <span>Todos os Roteiros</span>
        </a>
        
        {% if meses_menu %}
          <div class="mobile-menu-subtitle">Por M√™s:</div>
          {% for mes in meses_menu %}
            <a href="{{ mes.url }}" class="mobile-menu-link indent">
              <span class="menu-icon">üìÖ</span>
              <span>{{ mes.nome }}</span>
            </a>
          {% endfor %}
        {% endif %}
      </div>

      <a href="#contato" class="mobile-menu-link" onclick="closeMobileMenu()">
        <span class="menu-icon">üìû</span>
        <span>Contato</span>
      </a>
    </nav>
  </div>

  <main>
    {% block content %}{% endblock %}
  </main>

  <button id="backToTop" class="back-to-top" title="Voltar ao topo">‚Üë</button>

  <!-- Footer com identidade CN -->
  <footer class="site-footer cn-footer" id="contato" role="contentinfo">
    <!-- Barra superior azul CN -->
    <!-- Barra superior azul CN com logo alinhada -->
<div class="footer-top-bar">
  <div class="footer-bar-inner container">
    <img src="{{ BASE_PATH }}/static/img/marca_cancao_nova_png_v140517.png" 
         alt="Can√ß√£o Nova" class="footer-cn-logo">
  </div>
      
    /* -------------------------------------------------------
   FOOTER ‚Äî PADR√ÉO INSTITUCIONAL CAN√á√ÉO NOVA
---------------------------------------------------------*/

/* Barra azul superior */
.footer-top-bar {
  width: 100%;
  background: var(--cn-azul); /* Azul institucional */
  padding: 14px 0;
}

/* Container interno */
.footer-bar-inner {
  display: flex;
  align-items: center;
  justify-content: flex-start;
}

/* Logo dentro da faixa institucional */
.footer-cn-logo {
  height: 38px;
  filter: brightness(1); /* garante boa leitura */
  opacity: 0.95;

  /* Evita distor√ß√£o em mobile */
  max-width: 100%;
  object-fit: contain;
}

/* Remove a antiga logo do bloco principal */
.footer-logo img {
  display: none !important;
}

</div>
      <div class="footer-section">
        <h3 class="footer-title">Contato</h3>
        <div class="footer-contact">
          <p class="contact-item">
            <span class="contact-icon">üìû</span>
            <a href="tel:+556732117001">(67) 3211-7001</a>
          </p>
          
          <p class="contact-item">
            <span class="contact-icon">üí¨</span>
            <a href="https://wa.me/5567998927001?text=Ol√°! Gostaria de informa√ß√µes sobre os roteiros da Can√ß√£o Nova." target="_blank">
              WhatsApp
            </a>
          </p>
        </div>

        <a class="btn btn-whatsapp footer-cta" href="https://wa.me/5567998927001?text=Ol√°! Gostaria de informa√ß√µes sobre os roteiros da Can√ß√£o Nova." target="_blank">
          üí¨ Fale conosco
        </a>
      </div>

      <div class="footer-section">
        <h3 class="footer-title">Links R√°pidos</h3>
        <ul class="footer-links">
          <li><a href="{{ BASE_PATH }}/">In√≠cio</a></li>
          <li><a href="{{ BASE_PATH }}/roteiros/">Ver Roteiros</a></li>
          <li><a href="#contato">Contato</a></li>
        </ul>
      </div>
    </div>

    <!-- Copyright -->
    <div class="footer-bottom">
      <div class="container">
        <p>&copy; 2025 Comunidade Can√ß√£o Nova ‚Äî Todos os direitos reservados.</p>
        <p class="footer-legal">Peregrina√ß√µes Can√ß√£o Nova & S√£o Jos√© Peregrina√ß√µes (Operador Logistico</p>
      </div>
    </div>
  </footer>

<script>
/* Mobile Menu Toggle */
const mobileMenuToggle = document.getElementById('mobileMenuToggle');
const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
const body = document.body;

function openMobileMenu() {
  mobileMenuOverlay.classList.add('active');
  mobileMenuToggle.classList.add('active');
  mobileMenuToggle.setAttribute('aria-expanded', 'true');
  body.style.overflow = 'hidden'; // Previne scroll
}

function closeMobileMenu() {
  mobileMenuOverlay.classList.remove('active');
  mobileMenuToggle.classList.remove('active');
  mobileMenuToggle.setAttribute('aria-expanded', 'false');
  body.style.overflow = '';
}

if (mobileMenuToggle) {
  mobileMenuToggle.addEventListener('click', function() {
    if (mobileMenuOverlay.classList.contains('active')) {
      closeMobileMenu();
    } else {
      openMobileMenu();
    }
  });
}

// Fechar ao clicar fora do menu
if (mobileMenuOverlay) {
  mobileMenuOverlay.addEventListener('click', function(e) {
    if (e.target === mobileMenuOverlay) {
      closeMobileMenu();
    }
  });
}

// Fechar ao clicar em link
document.querySelectorAll('.mobile-menu-link').forEach(link => {
  link.addEventListener('click', function() {
    closeMobileMenu();
  });
});

/* Back to top */
const backToTopButton = document.getElementById('backToTop');
window.addEventListener('scroll', function() {
  if (window.pageYOffset > 300) backToTopButton.classList.add('show');
  else backToTopButton.classList.remove('show');
});
backToTopButton.addEventListener('click', function(){ window.scrollTo({ top: 0, behavior: 'smooth' }); });

/* Dropdown logic (preserve behavior) */
let dropdownTimeout;
function toggleDropdown(event){
  event.stopPropagation();
  const dropdown = document.getElementById('dropdownContent');
  if (!dropdown) return;
  const isVisible = dropdown.style.display === 'block';
  dropdown.style.display = isVisible ? 'none' : 'block';
}
const menuRoteiros = document.getElementById('menuRoteiros');
const dropdownContent = document.getElementById('dropdownContent');

if (menuRoteiros && dropdownContent){
  menuRoteiros.addEventListener('mouseenter', function(){ clearTimeout(dropdownTimeout); dropdownContent.style.display = 'block'; });
  menuRoteiros.addEventListener('mouseleave', function(){ dropdownTimeout = setTimeout(()=>dropdownContent.style.display='none', 260); });
  dropdownContent.addEventListener('mouseenter', function(){ clearTimeout(dropdownTimeout); });
  dropdownContent.addEventListener('mouseleave', function(){ dropdownTimeout = setTimeout(()=>dropdownContent.style.display='none', 260); });
}
document.addEventListener('click', function(e){
  const menu = document.getElementById('menuRoteiros');
  if (menu && !menu.contains(e.target)){ const dd = document.getElementById('dropdownContent'); if (dd) dd.style.display = 'none'; }
});
</script>
<script>
/* Carousel fade controller - accessible, autoplay, pause on hover, keyboard */
(function(){
  const carousel = document.getElementById('mainCarousel');
  if (!carousel) return;

  const track = carousel.querySelector('.carousel-track');
  const slides = Array.from(carousel.querySelectorAll('.carousel-slide'));
  const prevBtn = carousel.querySelector('[data-action="prev"]');
  const nextBtn = carousel.querySelector('[data-action="next"]');
  const indicators = Array.from(carousel.querySelectorAll('.indicator'));

  let current = 0;
  let interval = null;
  const delay = 6000;
  const fadeDuration = 900;

  function goTo(index){
    if (index < 0) index = slides.length - 1;
    if (index >= slides.length) index = 0;
    slides.forEach((s,i)=>{
      s.classList.toggle('is-active', i === index);
      if (indicators[i]) indicators[i].setAttribute('aria-selected', i === index ? 'true' : 'false');
    });
    current = index;
  }

  function next(){ goTo(current + 1); }
  function prev(){ goTo(current - 1); }

  function startAuto(){
    stopAuto();
    interval = setInterval(next, delay);
  }
  function stopAuto(){
    if (interval) { clearInterval(interval); interval = null; }
  }

  goTo(0);
  startAuto();

  if (nextBtn) nextBtn.addEventListener('click', ()=>{ next(); startAuto(); });
  if (prevBtn) prevBtn.addEventListener('click', ()=>{ prev(); startAuto(); });

  indicators.forEach(btn=>{
    btn.addEventListener('click', (e)=>{
      const idx = Number(btn.getAttribute('data-index'));
      goTo(idx);
      startAuto();
    });
  });

  carousel.addEventListener('mouseenter', stopAuto);
  carousel.addEventListener('mouseleave', startAuto);
  carousel.addEventListener('focusin', stopAuto);
  carousel.addEventListener('focusout', startAuto);

  document.addEventListener('keydown', function(e){
    if (['ArrowLeft','ArrowRight'].includes(e.key)){
      if (e.key === 'ArrowLeft') prev();
      if (e.key === 'ArrowRight') next();
      startAuto();
    }
  });

  const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)');
  if (prefersReduced.matches){
    stopAuto();
    slides.forEach((s,i)=> s.style.transition = 'none');
  }
})();
</script>

</body>
</html>
